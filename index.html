<html>
    <head>
        <title>
            Minimal Socket Example
        </title>
    </head>
    <body>
        <ul id="events"></ul>

        <form id="myForm">
            Enter message: <input id="message" type="text" />
            <input type="submit">
        </form>

        <script src="/socket.io/socket.io.js"></script> <!-- GET endpoint exposed when socket.io imported through server -->
        <script>

            const randomUserId = Math.floor(Math.random() * Math.floor(1000)); // random digit between 1 and 10
            const $events = document.getElementById('events');

            const newItem = (content) => {
                const item = document.createElement('li');
                item.innerText = content;
                return item;
            }

            const socket = io();

            // generic emitted event from socket.io 
            // only triggers on load/refresh
            socket.on('connect', () => {
                socket.emit('user connected', randomUserId);
            });

            // is it possible to show a live read on the online users

            socket.on('server message', (myMessage) => {
                $events.appendChild(newItem(myMessage));
            });

            document.getElementById('myForm').addEventListener('submit', function(event) {
                event.preventDefault();
                const message = document.getElementById('message').value;
                socket.emit('chat message', `${randomUserId}: ${message}`);
                document.getElementById('myForm').reset();
            });
        </script>
    </body>
</html>